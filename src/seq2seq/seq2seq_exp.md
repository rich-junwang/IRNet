
# BART checkpoint

/Users/zhiguow/anaconda3/envs/python3/bin/python /Users/zhiguow/PycharmProjects/zgwangNLP/src/misc_test.py
dict_keys(['args', 'model', 'optimizer_history', 'extra_state', 'last_optimizer_state'])
odict_keys(['encoder.version', 'encoder.embed_tokens.weight', 'encoder.embed_positions.weight', 'encoder.layers.0.self_attn.in_proj_weight', 'encoder.layers.0.self_attn.in_proj_bias', 'encoder.layers.0.self_attn.out_proj.weight', 'encoder.layers.0.self_attn.out_proj.bias', 'encoder.layers.0.fc1.weight', 'encoder.layers.0.fc1.bias', 'encoder.layers.0.fc2.weight', 'encoder.layers.0.fc2.bias', 'encoder.layers.0.layer_norms.0.weight', 'encoder.layers.0.layer_norms.0.bias', 'encoder.layers.0.layer_norms.1.weight', 'encoder.layers.0.layer_norms.1.bias', 'encoder.layers.1.self_attn.in_proj_weight', 'encoder.layers.1.self_attn.in_proj_bias', 'encoder.layers.1.self_attn.out_proj.weight', 'encoder.layers.1.self_attn.out_proj.bias', 'encoder.layers.1.fc1.weight', 'encoder.layers.1.fc1.bias', 'encoder.layers.1.fc2.weight', 'encoder.layers.1.fc2.bias', 'encoder.layers.1.layer_norms.0.weight', 'encoder.layers.1.layer_norms.0.bias', 'encoder.layers.1.layer_norms.1.weight', 'encoder.layers.1.layer_norms.1.bias', 'encoder.layers.2.self_attn.in_proj_weight', 'encoder.layers.2.self_attn.in_proj_bias', 'encoder.layers.2.self_attn.out_proj.weight', 'encoder.layers.2.self_attn.out_proj.bias', 'encoder.layers.2.fc1.weight', 'encoder.layers.2.fc1.bias', 'encoder.layers.2.fc2.weight', 'encoder.layers.2.fc2.bias', 'encoder.layers.2.layer_norms.0.weight', 'encoder.layers.2.layer_norms.0.bias', 'encoder.layers.2.layer_norms.1.weight', 'encoder.layers.2.layer_norms.1.bias', 'encoder.layers.3.self_attn.in_proj_weight', 'encoder.layers.3.self_attn.in_proj_bias', 'encoder.layers.3.self_attn.out_proj.weight', 'encoder.layers.3.self_attn.out_proj.bias', 'encoder.layers.3.fc1.weight', 'encoder.layers.3.fc1.bias', 'encoder.layers.3.fc2.weight', 'encoder.layers.3.fc2.bias', 'encoder.layers.3.layer_norms.0.weight', 'encoder.layers.3.layer_norms.0.bias', 'encoder.layers.3.layer_norms.1.weight', 'encoder.layers.3.layer_norms.1.bias', 'encoder.layers.4.self_attn.in_proj_weight', 'encoder.layers.4.self_attn.in_proj_bias', 'encoder.layers.4.self_attn.out_proj.weight', 'encoder.layers.4.self_attn.out_proj.bias', 'encoder.layers.4.fc1.weight', 'encoder.layers.4.fc1.bias', 'encoder.layers.4.fc2.weight', 'encoder.layers.4.fc2.bias', 'encoder.layers.4.layer_norms.0.weight', 'encoder.layers.4.layer_norms.0.bias', 'encoder.layers.4.layer_norms.1.weight', 'encoder.layers.4.layer_norms.1.bias', 'encoder.layers.5.self_attn.in_proj_weight', 'encoder.layers.5.self_attn.in_proj_bias', 'encoder.layers.5.self_attn.out_proj.weight', 'encoder.layers.5.self_attn.out_proj.bias', 'encoder.layers.5.fc1.weight', 'encoder.layers.5.fc1.bias', 'encoder.layers.5.fc2.weight', 'encoder.layers.5.fc2.bias', 'encoder.layers.5.layer_norms.0.weight', 'encoder.layers.5.layer_norms.0.bias', 'encoder.layers.5.layer_norms.1.weight', 'encoder.layers.5.layer_norms.1.bias', 'encoder.layers.6.self_attn.in_proj_weight', 'encoder.layers.6.self_attn.in_proj_bias', 'encoder.layers.6.self_attn.out_proj.weight', 'encoder.layers.6.self_attn.out_proj.bias', 'encoder.layers.6.fc1.weight', 'encoder.layers.6.fc1.bias', 'encoder.layers.6.fc2.weight', 'encoder.layers.6.fc2.bias', 'encoder.layers.6.layer_norms.0.weight', 'encoder.layers.6.layer_norms.0.bias', 'encoder.layers.6.layer_norms.1.weight', 'encoder.layers.6.layer_norms.1.bias', 'encoder.layers.7.self_attn.in_proj_weight', 'encoder.layers.7.self_attn.in_proj_bias', 'encoder.layers.7.self_attn.out_proj.weight', 'encoder.layers.7.self_attn.out_proj.bias', 'encoder.layers.7.fc1.weight', 'encoder.layers.7.fc1.bias', 'encoder.layers.7.fc2.weight', 'encoder.layers.7.fc2.bias', 'encoder.layers.7.layer_norms.0.weight', 'encoder.layers.7.layer_norms.0.bias', 'encoder.layers.7.layer_norms.1.weight', 'encoder.layers.7.layer_norms.1.bias', 'encoder.layers.8.self_attn.in_proj_weight', 'encoder.layers.8.self_attn.in_proj_bias', 'encoder.layers.8.self_attn.out_proj.weight', 'encoder.layers.8.self_attn.out_proj.bias', 'encoder.layers.8.fc1.weight', 'encoder.layers.8.fc1.bias', 'encoder.layers.8.fc2.weight', 'encoder.layers.8.fc2.bias', 'encoder.layers.8.layer_norms.0.weight', 'encoder.layers.8.layer_norms.0.bias', 'encoder.layers.8.layer_norms.1.weight', 'encoder.layers.8.layer_norms.1.bias', 'encoder.layers.9.self_attn.in_proj_weight', 'encoder.layers.9.self_attn.in_proj_bias', 'encoder.layers.9.self_attn.out_proj.weight', 'encoder.layers.9.self_attn.out_proj.bias', 'encoder.layers.9.fc1.weight', 'encoder.layers.9.fc1.bias', 'encoder.layers.9.fc2.weight', 'encoder.layers.9.fc2.bias', 'encoder.layers.9.layer_norms.0.weight', 'encoder.layers.9.layer_norms.0.bias', 'encoder.layers.9.layer_norms.1.weight', 'encoder.layers.9.layer_norms.1.bias', 'encoder.layers.10.self_attn.in_proj_weight', 'encoder.layers.10.self_attn.in_proj_bias', 'encoder.layers.10.self_attn.out_proj.weight', 'encoder.layers.10.self_attn.out_proj.bias', 'encoder.layers.10.fc1.weight', 'encoder.layers.10.fc1.bias', 'encoder.layers.10.fc2.weight', 'encoder.layers.10.fc2.bias', 'encoder.layers.10.layer_norms.0.weight', 'encoder.layers.10.layer_norms.0.bias', 'encoder.layers.10.layer_norms.1.weight', 'encoder.layers.10.layer_norms.1.bias', 'encoder.layers.11.self_attn.in_proj_weight', 'encoder.layers.11.self_attn.in_proj_bias', 'encoder.layers.11.self_attn.out_proj.weight', 'encoder.layers.11.self_attn.out_proj.bias', 'encoder.layers.11.fc1.weight', 'encoder.layers.11.fc1.bias', 'encoder.layers.11.fc2.weight', 'encoder.layers.11.fc2.bias', 'encoder.layers.11.layer_norms.0.weight', 'encoder.layers.11.layer_norms.0.bias', 'encoder.layers.11.layer_norms.1.weight', 'encoder.layers.11.layer_norms.1.bias', 'decoder.version', 'decoder.embed_tokens.weight', 'decoder.embed_positions.weight', 'decoder.layers.0.self_attn.in_proj_weight', 'decoder.layers.0.self_attn.in_proj_bias', 'decoder.layers.0.self_attn.out_proj.weight', 'decoder.layers.0.self_attn.out_proj.bias', 'decoder.layers.0.self_attn_layer_norm.weight', 'decoder.layers.0.self_attn_layer_norm.bias', 'decoder.layers.0.encoder_attn.in_proj_weight', 'decoder.layers.0.encoder_attn.in_proj_bias', 'decoder.layers.0.encoder_attn.out_proj.weight', 'decoder.layers.0.encoder_attn.out_proj.bias', 'decoder.layers.0.encoder_attn_layer_norm.weight', 'decoder.layers.0.encoder_attn_layer_norm.bias', 'decoder.layers.0.fc1.weight', 'decoder.layers.0.fc1.bias', 'decoder.layers.0.fc2.weight', 'decoder.layers.0.fc2.bias', 'decoder.layers.0.final_layer_norm.weight', 'decoder.layers.0.final_layer_norm.bias', 'decoder.layers.1.self_attn.in_proj_weight', 'decoder.layers.1.self_attn.in_proj_bias', 'decoder.layers.1.self_attn.out_proj.weight', 'decoder.layers.1.self_attn.out_proj.bias', 'decoder.layers.1.self_attn_layer_norm.weight', 'decoder.layers.1.self_attn_layer_norm.bias', 'decoder.layers.1.encoder_attn.in_proj_weight', 'decoder.layers.1.encoder_attn.in_proj_bias', 'decoder.layers.1.encoder_attn.out_proj.weight', 'decoder.layers.1.encoder_attn.out_proj.bias', 'decoder.layers.1.encoder_attn_layer_norm.weight', 'decoder.layers.1.encoder_attn_layer_norm.bias', 'decoder.layers.1.fc1.weight', 'decoder.layers.1.fc1.bias', 'decoder.layers.1.fc2.weight', 'decoder.layers.1.fc2.bias', 'decoder.layers.1.final_layer_norm.weight', 'decoder.layers.1.final_layer_norm.bias', 'decoder.layers.2.self_attn.in_proj_weight', 'decoder.layers.2.self_attn.in_proj_bias', 'decoder.layers.2.self_attn.out_proj.weight', 'decoder.layers.2.self_attn.out_proj.bias', 'decoder.layers.2.self_attn_layer_norm.weight', 'decoder.layers.2.self_attn_layer_norm.bias', 'decoder.layers.2.encoder_attn.in_proj_weight', 'decoder.layers.2.encoder_attn.in_proj_bias', 'decoder.layers.2.encoder_attn.out_proj.weight', 'decoder.layers.2.encoder_attn.out_proj.bias', 'decoder.layers.2.encoder_attn_layer_norm.weight', 'decoder.layers.2.encoder_attn_layer_norm.bias', 'decoder.layers.2.fc1.weight', 'decoder.layers.2.fc1.bias', 'decoder.layers.2.fc2.weight', 'decoder.layers.2.fc2.bias', 'decoder.layers.2.final_layer_norm.weight', 'decoder.layers.2.final_layer_norm.bias', 'decoder.layers.3.self_attn.in_proj_weight', 'decoder.layers.3.self_attn.in_proj_bias', 'decoder.layers.3.self_attn.out_proj.weight', 'decoder.layers.3.self_attn.out_proj.bias', 'decoder.layers.3.self_attn_layer_norm.weight', 'decoder.layers.3.self_attn_layer_norm.bias', 'decoder.layers.3.encoder_attn.in_proj_weight', 'decoder.layers.3.encoder_attn.in_proj_bias', 'decoder.layers.3.encoder_attn.out_proj.weight', 'decoder.layers.3.encoder_attn.out_proj.bias', 'decoder.layers.3.encoder_attn_layer_norm.weight', 'decoder.layers.3.encoder_attn_layer_norm.bias', 'decoder.layers.3.fc1.weight', 'decoder.layers.3.fc1.bias', 'decoder.layers.3.fc2.weight', 'decoder.layers.3.fc2.bias', 'decoder.layers.3.final_layer_norm.weight', 'decoder.layers.3.final_layer_norm.bias', 'decoder.layers.4.self_attn.in_proj_weight', 'decoder.layers.4.self_attn.in_proj_bias', 'decoder.layers.4.self_attn.out_proj.weight', 'decoder.layers.4.self_attn.out_proj.bias', 'decoder.layers.4.self_attn_layer_norm.weight', 'decoder.layers.4.self_attn_layer_norm.bias', 'decoder.layers.4.encoder_attn.in_proj_weight', 'decoder.layers.4.encoder_attn.in_proj_bias', 'decoder.layers.4.encoder_attn.out_proj.weight', 'decoder.layers.4.encoder_attn.out_proj.bias', 'decoder.layers.4.encoder_attn_layer_norm.weight', 'decoder.layers.4.encoder_attn_layer_norm.bias', 'decoder.layers.4.fc1.weight', 'decoder.layers.4.fc1.bias', 'decoder.layers.4.fc2.weight', 'decoder.layers.4.fc2.bias', 'decoder.layers.4.final_layer_norm.weight', 'decoder.layers.4.final_layer_norm.bias', 'decoder.layers.5.self_attn.in_proj_weight', 'decoder.layers.5.self_attn.in_proj_bias', 'decoder.layers.5.self_attn.out_proj.weight', 'decoder.layers.5.self_attn.out_proj.bias', 'decoder.layers.5.self_attn_layer_norm.weight', 'decoder.layers.5.self_attn_layer_norm.bias', 'decoder.layers.5.encoder_attn.in_proj_weight', 'decoder.layers.5.encoder_attn.in_proj_bias', 'decoder.layers.5.encoder_attn.out_proj.weight', 'decoder.layers.5.encoder_attn.out_proj.bias', 'decoder.layers.5.encoder_attn_layer_norm.weight', 'decoder.layers.5.encoder_attn_layer_norm.bias', 'decoder.layers.5.fc1.weight', 'decoder.layers.5.fc1.bias', 'decoder.layers.5.fc2.weight', 'decoder.layers.5.fc2.bias', 'decoder.layers.5.final_layer_norm.weight', 'decoder.layers.5.final_layer_norm.bias', 'decoder.layers.6.self_attn.in_proj_weight', 'decoder.layers.6.self_attn.in_proj_bias', 'decoder.layers.6.self_attn.out_proj.weight', 'decoder.layers.6.self_attn.out_proj.bias', 'decoder.layers.6.self_attn_layer_norm.weight', 'decoder.layers.6.self_attn_layer_norm.bias', 'decoder.layers.6.encoder_attn.in_proj_weight', 'decoder.layers.6.encoder_attn.in_proj_bias', 'decoder.layers.6.encoder_attn.out_proj.weight', 'decoder.layers.6.encoder_attn.out_proj.bias', 'decoder.layers.6.encoder_attn_layer_norm.weight', 'decoder.layers.6.encoder_attn_layer_norm.bias', 'decoder.layers.6.fc1.weight', 'decoder.layers.6.fc1.bias', 'decoder.layers.6.fc2.weight', 'decoder.layers.6.fc2.bias', 'decoder.layers.6.final_layer_norm.weight', 'decoder.layers.6.final_layer_norm.bias', 'decoder.layers.7.self_attn.in_proj_weight', 'decoder.layers.7.self_attn.in_proj_bias', 'decoder.layers.7.self_attn.out_proj.weight', 'decoder.layers.7.self_attn.out_proj.bias', 'decoder.layers.7.self_attn_layer_norm.weight', 'decoder.layers.7.self_attn_layer_norm.bias', 'decoder.layers.7.encoder_attn.in_proj_weight', 'decoder.layers.7.encoder_attn.in_proj_bias', 'decoder.layers.7.encoder_attn.out_proj.weight', 'decoder.layers.7.encoder_attn.out_proj.bias', 'decoder.layers.7.encoder_attn_layer_norm.weight', 'decoder.layers.7.encoder_attn_layer_norm.bias', 'decoder.layers.7.fc1.weight', 'decoder.layers.7.fc1.bias', 'decoder.layers.7.fc2.weight', 'decoder.layers.7.fc2.bias', 'decoder.layers.7.final_layer_norm.weight', 'decoder.layers.7.final_layer_norm.bias', 'decoder.layers.8.self_attn.in_proj_weight', 'decoder.layers.8.self_attn.in_proj_bias', 'decoder.layers.8.self_attn.out_proj.weight', 'decoder.layers.8.self_attn.out_proj.bias', 'decoder.layers.8.self_attn_layer_norm.weight', 'decoder.layers.8.self_attn_layer_norm.bias', 'decoder.layers.8.encoder_attn.in_proj_weight', 'decoder.layers.8.encoder_attn.in_proj_bias', 'decoder.layers.8.encoder_attn.out_proj.weight', 'decoder.layers.8.encoder_attn.out_proj.bias', 'decoder.layers.8.encoder_attn_layer_norm.weight', 'decoder.layers.8.encoder_attn_layer_norm.bias', 'decoder.layers.8.fc1.weight', 'decoder.layers.8.fc1.bias', 'decoder.layers.8.fc2.weight', 'decoder.layers.8.fc2.bias', 'decoder.layers.8.final_layer_norm.weight', 'decoder.layers.8.final_layer_norm.bias', 'decoder.layers.9.self_attn.in_proj_weight', 'decoder.layers.9.self_attn.in_proj_bias', 'decoder.layers.9.self_attn.out_proj.weight', 'decoder.layers.9.self_attn.out_proj.bias', 'decoder.layers.9.self_attn_layer_norm.weight', 'decoder.layers.9.self_attn_layer_norm.bias', 'decoder.layers.9.encoder_attn.in_proj_weight', 'decoder.layers.9.encoder_attn.in_proj_bias', 'decoder.layers.9.encoder_attn.out_proj.weight', 'decoder.layers.9.encoder_attn.out_proj.bias', 'decoder.layers.9.encoder_attn_layer_norm.weight', 'decoder.layers.9.encoder_attn_layer_norm.bias', 'decoder.layers.9.fc1.weight', 'decoder.layers.9.fc1.bias', 'decoder.layers.9.fc2.weight', 'decoder.layers.9.fc2.bias', 'decoder.layers.9.final_layer_norm.weight', 'decoder.layers.9.final_layer_norm.bias', 'decoder.layers.10.self_attn.in_proj_weight', 'decoder.layers.10.self_attn.in_proj_bias', 'decoder.layers.10.self_attn.out_proj.weight', 'decoder.layers.10.self_attn.out_proj.bias', 'decoder.layers.10.self_attn_layer_norm.weight', 'decoder.layers.10.self_attn_layer_norm.bias', 'decoder.layers.10.encoder_attn.in_proj_weight', 'decoder.layers.10.encoder_attn.in_proj_bias', 'decoder.layers.10.encoder_attn.out_proj.weight', 'decoder.layers.10.encoder_attn.out_proj.bias', 'decoder.layers.10.encoder_attn_layer_norm.weight', 'decoder.layers.10.encoder_attn_layer_norm.bias', 'decoder.layers.10.fc1.weight', 'decoder.layers.10.fc1.bias', 'decoder.layers.10.fc2.weight', 'decoder.layers.10.fc2.bias', 'decoder.layers.10.final_layer_norm.weight', 'decoder.layers.10.final_layer_norm.bias', 'decoder.layers.11.self_attn.in_proj_weight', 'decoder.layers.11.self_attn.in_proj_bias', 'decoder.layers.11.self_attn.out_proj.weight', 'decoder.layers.11.self_attn.out_proj.bias', 'decoder.layers.11.self_attn_layer_norm.weight', 'decoder.layers.11.self_attn_layer_norm.bias', 'decoder.layers.11.encoder_attn.in_proj_weight', 'decoder.layers.11.encoder_attn.in_proj_bias', 'decoder.layers.11.encoder_attn.out_proj.weight', 'decoder.layers.11.encoder_attn.out_proj.bias', 'decoder.layers.11.encoder_attn_layer_norm.weight', 'decoder.layers.11.encoder_attn_layer_norm.bias', 'decoder.layers.11.fc1.weight', 'decoder.layers.11.fc1.bias', 'decoder.layers.11.fc2.weight', 'decoder.layers.11.fc2.bias', 'decoder.layers.11.final_layer_norm.weight', 'decoder.layers.11.final_layer_norm.bias', 'encoder.layernorm_embedding.weight', 'encoder.layernorm_embedding.bias', 'decoder.layernorm_embedding.weight', 'decoder.layernorm_embedding.bias'])
encoder.version torch.Size([1])
encoder.embed_tokens.weight torch.Size([50265, 1024])
encoder.embed_positions.weight torch.Size([1026, 1024])
encoder.layers.0.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.0.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.0.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.0.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.0.fc1.weight torch.Size([4096, 1024])
encoder.layers.0.fc1.bias torch.Size([4096])
encoder.layers.0.fc2.weight torch.Size([1024, 4096])
encoder.layers.0.fc2.bias torch.Size([1024])
encoder.layers.0.layer_norms.0.weight torch.Size([1024])
encoder.layers.0.layer_norms.0.bias torch.Size([1024])
encoder.layers.0.layer_norms.1.weight torch.Size([1024])
encoder.layers.0.layer_norms.1.bias torch.Size([1024])
encoder.layers.1.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.1.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.1.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.1.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.1.fc1.weight torch.Size([4096, 1024])
encoder.layers.1.fc1.bias torch.Size([4096])
encoder.layers.1.fc2.weight torch.Size([1024, 4096])
encoder.layers.1.fc2.bias torch.Size([1024])
encoder.layers.1.layer_norms.0.weight torch.Size([1024])
encoder.layers.1.layer_norms.0.bias torch.Size([1024])
encoder.layers.1.layer_norms.1.weight torch.Size([1024])
encoder.layers.1.layer_norms.1.bias torch.Size([1024])
encoder.layers.2.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.2.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.2.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.2.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.2.fc1.weight torch.Size([4096, 1024])
encoder.layers.2.fc1.bias torch.Size([4096])
encoder.layers.2.fc2.weight torch.Size([1024, 4096])
encoder.layers.2.fc2.bias torch.Size([1024])
encoder.layers.2.layer_norms.0.weight torch.Size([1024])
encoder.layers.2.layer_norms.0.bias torch.Size([1024])
encoder.layers.2.layer_norms.1.weight torch.Size([1024])
encoder.layers.2.layer_norms.1.bias torch.Size([1024])
encoder.layers.3.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.3.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.3.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.3.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.3.fc1.weight torch.Size([4096, 1024])
encoder.layers.3.fc1.bias torch.Size([4096])
encoder.layers.3.fc2.weight torch.Size([1024, 4096])
encoder.layers.3.fc2.bias torch.Size([1024])
encoder.layers.3.layer_norms.0.weight torch.Size([1024])
encoder.layers.3.layer_norms.0.bias torch.Size([1024])
encoder.layers.3.layer_norms.1.weight torch.Size([1024])
encoder.layers.3.layer_norms.1.bias torch.Size([1024])
encoder.layers.4.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.4.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.4.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.4.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.4.fc1.weight torch.Size([4096, 1024])
encoder.layers.4.fc1.bias torch.Size([4096])
encoder.layers.4.fc2.weight torch.Size([1024, 4096])
encoder.layers.4.fc2.bias torch.Size([1024])
encoder.layers.4.layer_norms.0.weight torch.Size([1024])
encoder.layers.4.layer_norms.0.bias torch.Size([1024])
encoder.layers.4.layer_norms.1.weight torch.Size([1024])
encoder.layers.4.layer_norms.1.bias torch.Size([1024])
encoder.layers.5.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.5.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.5.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.5.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.5.fc1.weight torch.Size([4096, 1024])
encoder.layers.5.fc1.bias torch.Size([4096])
encoder.layers.5.fc2.weight torch.Size([1024, 4096])
encoder.layers.5.fc2.bias torch.Size([1024])
encoder.layers.5.layer_norms.0.weight torch.Size([1024])
encoder.layers.5.layer_norms.0.bias torch.Size([1024])
encoder.layers.5.layer_norms.1.weight torch.Size([1024])
encoder.layers.5.layer_norms.1.bias torch.Size([1024])
encoder.layers.6.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.6.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.6.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.6.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.6.fc1.weight torch.Size([4096, 1024])
encoder.layers.6.fc1.bias torch.Size([4096])
encoder.layers.6.fc2.weight torch.Size([1024, 4096])
encoder.layers.6.fc2.bias torch.Size([1024])
encoder.layers.6.layer_norms.0.weight torch.Size([1024])
encoder.layers.6.layer_norms.0.bias torch.Size([1024])
encoder.layers.6.layer_norms.1.weight torch.Size([1024])
encoder.layers.6.layer_norms.1.bias torch.Size([1024])
encoder.layers.7.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.7.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.7.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.7.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.7.fc1.weight torch.Size([4096, 1024])
encoder.layers.7.fc1.bias torch.Size([4096])
encoder.layers.7.fc2.weight torch.Size([1024, 4096])
encoder.layers.7.fc2.bias torch.Size([1024])
encoder.layers.7.layer_norms.0.weight torch.Size([1024])
encoder.layers.7.layer_norms.0.bias torch.Size([1024])
encoder.layers.7.layer_norms.1.weight torch.Size([1024])
encoder.layers.7.layer_norms.1.bias torch.Size([1024])
encoder.layers.8.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.8.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.8.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.8.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.8.fc1.weight torch.Size([4096, 1024])
encoder.layers.8.fc1.bias torch.Size([4096])
encoder.layers.8.fc2.weight torch.Size([1024, 4096])
encoder.layers.8.fc2.bias torch.Size([1024])
encoder.layers.8.layer_norms.0.weight torch.Size([1024])
encoder.layers.8.layer_norms.0.bias torch.Size([1024])
encoder.layers.8.layer_norms.1.weight torch.Size([1024])
encoder.layers.8.layer_norms.1.bias torch.Size([1024])
encoder.layers.9.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.9.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.9.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.9.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.9.fc1.weight torch.Size([4096, 1024])
encoder.layers.9.fc1.bias torch.Size([4096])
encoder.layers.9.fc2.weight torch.Size([1024, 4096])
encoder.layers.9.fc2.bias torch.Size([1024])
encoder.layers.9.layer_norms.0.weight torch.Size([1024])
encoder.layers.9.layer_norms.0.bias torch.Size([1024])
encoder.layers.9.layer_norms.1.weight torch.Size([1024])
encoder.layers.9.layer_norms.1.bias torch.Size([1024])
encoder.layers.10.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.10.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.10.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.10.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.10.fc1.weight torch.Size([4096, 1024])
encoder.layers.10.fc1.bias torch.Size([4096])
encoder.layers.10.fc2.weight torch.Size([1024, 4096])
encoder.layers.10.fc2.bias torch.Size([1024])
encoder.layers.10.layer_norms.0.weight torch.Size([1024])
encoder.layers.10.layer_norms.0.bias torch.Size([1024])
encoder.layers.10.layer_norms.1.weight torch.Size([1024])
encoder.layers.10.layer_norms.1.bias torch.Size([1024])
encoder.layers.11.self_attn.in_proj_weight torch.Size([3072, 1024])
encoder.layers.11.self_attn.in_proj_bias torch.Size([3072])
encoder.layers.11.self_attn.out_proj.weight torch.Size([1024, 1024])
encoder.layers.11.self_attn.out_proj.bias torch.Size([1024])
encoder.layers.11.fc1.weight torch.Size([4096, 1024])
encoder.layers.11.fc1.bias torch.Size([4096])
encoder.layers.11.fc2.weight torch.Size([1024, 4096])
encoder.layers.11.fc2.bias torch.Size([1024])
encoder.layers.11.layer_norms.0.weight torch.Size([1024])
encoder.layers.11.layer_norms.0.bias torch.Size([1024])
encoder.layers.11.layer_norms.1.weight torch.Size([1024])
encoder.layers.11.layer_norms.1.bias torch.Size([1024])
decoder.version torch.Size([1])
decoder.embed_tokens.weight torch.Size([50265, 1024])
decoder.embed_positions.weight torch.Size([1026, 1024])
decoder.layers.0.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.0.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.0.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.0.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.0.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.0.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.0.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.0.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.0.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.0.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.0.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.0.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.0.fc1.weight torch.Size([4096, 1024])
decoder.layers.0.fc1.bias torch.Size([4096])
decoder.layers.0.fc2.weight torch.Size([1024, 4096])
decoder.layers.0.fc2.bias torch.Size([1024])
decoder.layers.0.final_layer_norm.weight torch.Size([1024])
decoder.layers.0.final_layer_norm.bias torch.Size([1024])
decoder.layers.1.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.1.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.1.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.1.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.1.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.1.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.1.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.1.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.1.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.1.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.1.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.1.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.1.fc1.weight torch.Size([4096, 1024])
decoder.layers.1.fc1.bias torch.Size([4096])
decoder.layers.1.fc2.weight torch.Size([1024, 4096])
decoder.layers.1.fc2.bias torch.Size([1024])
decoder.layers.1.final_layer_norm.weight torch.Size([1024])
decoder.layers.1.final_layer_norm.bias torch.Size([1024])
decoder.layers.2.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.2.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.2.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.2.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.2.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.2.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.2.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.2.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.2.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.2.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.2.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.2.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.2.fc1.weight torch.Size([4096, 1024])
decoder.layers.2.fc1.bias torch.Size([4096])
decoder.layers.2.fc2.weight torch.Size([1024, 4096])
decoder.layers.2.fc2.bias torch.Size([1024])
decoder.layers.2.final_layer_norm.weight torch.Size([1024])
decoder.layers.2.final_layer_norm.bias torch.Size([1024])
decoder.layers.3.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.3.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.3.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.3.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.3.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.3.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.3.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.3.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.3.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.3.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.3.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.3.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.3.fc1.weight torch.Size([4096, 1024])
decoder.layers.3.fc1.bias torch.Size([4096])
decoder.layers.3.fc2.weight torch.Size([1024, 4096])
decoder.layers.3.fc2.bias torch.Size([1024])
decoder.layers.3.final_layer_norm.weight torch.Size([1024])
decoder.layers.3.final_layer_norm.bias torch.Size([1024])
decoder.layers.4.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.4.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.4.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.4.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.4.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.4.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.4.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.4.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.4.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.4.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.4.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.4.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.4.fc1.weight torch.Size([4096, 1024])
decoder.layers.4.fc1.bias torch.Size([4096])
decoder.layers.4.fc2.weight torch.Size([1024, 4096])
decoder.layers.4.fc2.bias torch.Size([1024])
decoder.layers.4.final_layer_norm.weight torch.Size([1024])
decoder.layers.4.final_layer_norm.bias torch.Size([1024])
decoder.layers.5.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.5.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.5.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.5.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.5.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.5.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.5.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.5.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.5.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.5.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.5.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.5.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.5.fc1.weight torch.Size([4096, 1024])
decoder.layers.5.fc1.bias torch.Size([4096])
decoder.layers.5.fc2.weight torch.Size([1024, 4096])
decoder.layers.5.fc2.bias torch.Size([1024])
decoder.layers.5.final_layer_norm.weight torch.Size([1024])
decoder.layers.5.final_layer_norm.bias torch.Size([1024])
decoder.layers.6.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.6.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.6.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.6.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.6.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.6.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.6.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.6.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.6.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.6.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.6.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.6.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.6.fc1.weight torch.Size([4096, 1024])
decoder.layers.6.fc1.bias torch.Size([4096])
decoder.layers.6.fc2.weight torch.Size([1024, 4096])
decoder.layers.6.fc2.bias torch.Size([1024])
decoder.layers.6.final_layer_norm.weight torch.Size([1024])
decoder.layers.6.final_layer_norm.bias torch.Size([1024])
decoder.layers.7.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.7.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.7.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.7.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.7.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.7.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.7.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.7.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.7.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.7.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.7.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.7.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.7.fc1.weight torch.Size([4096, 1024])
decoder.layers.7.fc1.bias torch.Size([4096])
decoder.layers.7.fc2.weight torch.Size([1024, 4096])
decoder.layers.7.fc2.bias torch.Size([1024])
decoder.layers.7.final_layer_norm.weight torch.Size([1024])
decoder.layers.7.final_layer_norm.bias torch.Size([1024])
decoder.layers.8.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.8.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.8.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.8.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.8.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.8.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.8.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.8.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.8.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.8.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.8.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.8.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.8.fc1.weight torch.Size([4096, 1024])
decoder.layers.8.fc1.bias torch.Size([4096])
decoder.layers.8.fc2.weight torch.Size([1024, 4096])
decoder.layers.8.fc2.bias torch.Size([1024])
decoder.layers.8.final_layer_norm.weight torch.Size([1024])
decoder.layers.8.final_layer_norm.bias torch.Size([1024])
decoder.layers.9.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.9.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.9.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.9.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.9.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.9.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.9.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.9.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.9.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.9.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.9.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.9.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.9.fc1.weight torch.Size([4096, 1024])
decoder.layers.9.fc1.bias torch.Size([4096])
decoder.layers.9.fc2.weight torch.Size([1024, 4096])
decoder.layers.9.fc2.bias torch.Size([1024])
decoder.layers.9.final_layer_norm.weight torch.Size([1024])
decoder.layers.9.final_layer_norm.bias torch.Size([1024])
decoder.layers.10.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.10.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.10.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.10.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.10.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.10.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.10.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.10.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.10.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.10.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.10.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.10.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.10.fc1.weight torch.Size([4096, 1024])
decoder.layers.10.fc1.bias torch.Size([4096])
decoder.layers.10.fc2.weight torch.Size([1024, 4096])
decoder.layers.10.fc2.bias torch.Size([1024])
decoder.layers.10.final_layer_norm.weight torch.Size([1024])
decoder.layers.10.final_layer_norm.bias torch.Size([1024])
decoder.layers.11.self_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.11.self_attn.in_proj_bias torch.Size([3072])
decoder.layers.11.self_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.11.self_attn.out_proj.bias torch.Size([1024])
decoder.layers.11.self_attn_layer_norm.weight torch.Size([1024])
decoder.layers.11.self_attn_layer_norm.bias torch.Size([1024])
decoder.layers.11.encoder_attn.in_proj_weight torch.Size([3072, 1024])
decoder.layers.11.encoder_attn.in_proj_bias torch.Size([3072])
decoder.layers.11.encoder_attn.out_proj.weight torch.Size([1024, 1024])
decoder.layers.11.encoder_attn.out_proj.bias torch.Size([1024])
decoder.layers.11.encoder_attn_layer_norm.weight torch.Size([1024])
decoder.layers.11.encoder_attn_layer_norm.bias torch.Size([1024])
decoder.layers.11.fc1.weight torch.Size([4096, 1024])
decoder.layers.11.fc1.bias torch.Size([4096])
decoder.layers.11.fc2.weight torch.Size([1024, 4096])
decoder.layers.11.fc2.bias torch.Size([1024])
decoder.layers.11.final_layer_norm.weight torch.Size([1024])
decoder.layers.11.final_layer_norm.bias torch.Size([1024])
encoder.layernorm_embedding.weight torch.Size([1024])
encoder.layernorm_embedding.bias torch.Size([1024])
decoder.layernorm_embedding.weight torch.Size([1024])
decoder.layernorm_embedding.bias torch.Size([1024])
Namespace(activation_fn='gelu', adam_betas='(0.9, 0.999)', adam_eps=1e-06, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='bart_large', attention_dropout=0.1, best_checkpoint_metric='loss', bilm_add_bos=False, bilm_attention_dropout=0.0, bilm_mask_last_state=False, bilm_model_dropout=0.1, bilm_relu_dropout=0.0, bpe='gpt2', bucket_cap_mb=25, clip_norm=0.1, cpu=False, criterion='cross_entropy', curriculum=0, data='/private/home/myleott/data/data-bin/bookwiki_CC-NEWS_openwebtext_stories-mmap2-bin/', dataset_impl='mmap', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_embed_scale=1.0, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=12, decoder_learned_pos=True, decoder_normalize_before=False, decoder_output_dim=1024, decoder_to_encoder_attention_layers=12, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://learnfair1688:55498', distributed_no_spawn=True, distributed_port=55498, distributed_rank=0, distributed_world_size=256, dropout=0.1, embedding_only=False, encoder_attention_heads=16, encoder_embed_dim=1024, encoder_embed_path=None, encoder_embed_scale=1.0, encoder_ffn_embed_dim=4096, encoder_layers=12, encoder_learned_pos=True, encoder_normalize_before=False, end_learning_rate=0.0, fast_stat_sync=False, find_unused_parameters=False, fix_batches_to_gpus=False, force_anneal=None, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, geometric_p=0.2, gpt2_encoder_json='https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json', gpt2_vocab_bpe='https://dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe', insert=0.0, jigsaw=0.0, keep_interval_updates=-1, keep_last_epochs=-1, layernorm_embedding=True, layernorm_extra=True, log_format='json', log_interval=10, lr=[0.0004], lr_scheduler='polynomial_decay', mask=0.3, mask_length='span-poisson', mask_random=0.1, mass=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_source_positions_summarization=None, max_target_positions=1024, max_target_positions_summarization=None, max_tokens=3200, max_tokens_valid=3200, max_update=500000, maximize_best_checkpoint_metric=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=-1, no_dec_token_positional_embeddings=False, no_enc_token_positional_embeddings=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, num_workers=4, optimizer='adam', optimizer_overrides='{}', permute=0.0, permute_sentences=1.0, poisson_lambda=3.5, pooler_activation_fn='tanh', pooler_dropout=0.0, power=1.0, randomize_start=False, raw_text=False, relu_dropout=0.0, replace_length=1, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', rotate=0.0, sample_break_mode='complete_doc', save_dir='/checkpoint/lsz/2019-10-10/nosca.denoising_large.tps512.mt3200.uf4.mu500000.extraln.ees1.0.des1.0.dr0.1.atdr0.1.actdr0.0.wd0.01.adam.eps1e-06.clip0.1.lr0.0004.warm10000.fp16.poi_lam3.5.mask0.3.ssp0.0.mask_lenspan-poisson.rpl_len1.rotate0.mask_rand0.1.ins0.perm_sen1.0.seed4.ngpu256', save_interval=1, save_interval_updates=5000, seed=4, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=True, short_seq_prob=0.0, shuffle_instance=False, skip_invalid_size_inputs_valid_test=True, task='denoising', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, tokenizer=None, tokens_per_sample=512, total_num_update=500000, train_subset='train', update_freq=[4], use_bmuf=False, user_dir=None, valid_subset='valid', validate_interval=1, verbose=False, warmup_updates=10000, weight_decay=0.01)


# February 18, 2020: debug seq2seq model
## copy pretrained model to EC2
scp -i /Users/zhiguow/Documents/2018-12-02AmazonKeyPair/zhiguow-4gpus.pem -r /Users/zhiguow/Downloads/pretrained_bart_model ubuntu@ec2-3-81-29-102.compute-1.amazonaws.com:/home/ubuntu/zhiguow_EBS/exps/zgwangNLP/models


scp -i /Users/zhiguow/Documents/2018-12-02AmazonKeyPair/zhiguow-4gpus.pem -r ubuntu@ec2-3-81-29-102.compute-1.amazonaws.com:/home/ubuntu/zhiguow_EBS/exps/seq2seq/QG/SQuAD_dev.jsonl .
scp -i /Users/zhiguow/Documents/2018-12-02AmazonKeyPair/zhiguow-4gpus.pem -r /Users/zhiguow/Downloads/val.json ubuntu@ec2-3-81-29-102.compute-1.amazonaws.com:/home/ubuntu/zhiguow_EBS/exps/seq2seq/QG/




/home/ubuntu/zhiguow_EBS/exps/seq2seq

## copy code
scp -i /Users/zhiguow/Documents/2018-12-02AmazonKeyPair/zhiguow-4gpus.pem -r /Users/zhiguow/PycharmProjects/zgwangNLP/src/* ubuntu@ec2-3-81-29-102.compute-1.amazonaws.com:/home/ubuntu/zhiguow_EBS/exps/zgwangNLP/src



## install latest pytorch
conda create --name zhiguow_pytorch --clone zhiguow_python3
source activate zhiguow_pytorch

## train model
/home/ubuntu/zhiguow_EBS/exps/zgwangNLP/src/train.sh

## make prediction
CUDA_VISIBLE_DEVICES=3 python /home/ubuntu/zhiguow_EBS/exps/zgwangNLP/src/predictor.py --pretrained_path /home/ubuntu/zhiguow_EBS/exps/zgwangNLP/models/bart_large_model --model_dir ./models --in_path ./val.json --out_path ./prediction

# February 18, 2020: question generation

## upload pre-trained model
s3://zhiguow-data/pretrained_model/bart_large_model/

## create docker image
./build_and_push.sh zgwangnlp


## preprocess dataset
/home/ubuntu/zhiguow_EBS/exps/seq2seq

python /home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP/src/seq2seq/seq2seq_misc.py --in_path MRQA_no_searchQA.jsonl --out_path train.json

python /home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP/src/seq2seq/seq2seq_misc.py --in_path SQuAD_dev.jsonl --out_path val.json

## launch sagemaker job
s3://zhiguow-data/question_generation/exp20200219/

https://us-east-2.console.aws.amazon.com/sagemaker/home?region=us-east-2#/jobs/question-generation-exp20200219-2020-02-19-15-02-07-771


## preprocess dataset
export ZGWANGNLPDIR=/home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP
PYTHONPATH=${ZGWANGNLPDIR}/src/ python ${ZGWANGNLPDIR}/src/data_generator.py --config_path ./exp.config


CUDA_VISIBLE_DEVICES=3 python /home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP/src/sagemaker_train.py


## evaluation
export ZGWANGNLPDIR=/home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP
PYTHONPATH=${ZGWANGNLPDIR}/src/ python ${ZGWANGNLPDIR}/src/seq2seq/seq2seq_misc.py

BLEU = 22.46, 55.2/29.2/19.3/13.4 (BP=0.884, ratio=0.890, hyp_len=107779, ref_len=121115)


/home/ubuntu/zhiguow_EBS/exps/docker/zgwangNLP/src/seq2seq/seq2seq_misc.py